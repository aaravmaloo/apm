name: "Secure Enterprise Policy"

# Password Complexity Rules
# Defines the minimum requirements for all new or updated passwords.
password_policy:
  min_length: 14                  # Minimum number of characters
  require_uppercase: true         # Must contain at least one uppercase letter (A-Z)
  require_numbers: true           # Must contain at least one digit (0-9)
  require_symbols: true           # Must contain at least one special character (!@#$%)
  
# Rotation & Expiry Rules
# Defines how often secrets should be rotated and when to notify users.
rotation_policy:
  rotate_every_days: 60           # Max age of a password before it's marked as expired (Health Check)
  notify_before_days: 14          # Days before expiry to start showing warnings

# Data Classification & Access Control
# Defines sensitivity levels for specific entry tags or namespaces.
# These rules are enforced by the 'apm health' and Team Edition access controls.
classification:
  "prod_db":
    max_access_level: "admin"     # Only users with 'admin' role can access entries tagged 'prod_db'
    mfa_required: true            # Accessing these entries triggers an MFA challenge
  
  "finance":
    max_access_level: "manager"
    mfa_required: true
    audit_logging: "strict"       # Log every access attempt immediately to security channel

  "internal_tool":
    max_access_level: "user"
    mfa_required: false

# Approved Integrations (Future Compliance)
# Whitelist of allowed plugin capabilities for this policy scope.
allowed_plugins:
  - "aws_secrets_manager"
  - "slack_notifier"

# Advanced constraints (Custom RegEx)
# Enforce specific patterns for entry labels or usernames (e.g., corporate email required).
naming_convention:
  username_regex: "^[a-z0-9._%+-]+@company\\.com$"
  label_regex: "^(PROD|DEV|STAGE)-.+"
